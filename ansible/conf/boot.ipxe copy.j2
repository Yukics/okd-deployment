#!ipxe

# Some menu defaults
#set menu-timeout 5000
#set submenu-timeout ${menu-timeout}
#isset ${menu-default} || set menu-default exit
#set esc:hex 1b
#set bold ${esc:string}[1m
#set orange ${esc:string}[33;0m
#set yellow ${esc:string}[33;1m
#set cyan ${esc:string}[36;1m
#set resetfg ${esc:string}[39m
#set resetbg ${esc:string}[49m
#set resetbold ${esc:string}[22m
#set reset ${esc:string}[0m

# Figure out if client is 64-bit capable
#cpuid --ext 29 && set arch x86_64 || set arch x86
#cpuid --ext 29 && set archb 64 || set archb 32
#cpuid --ext 29 && set archl x86_64 || set archl i386

# Set graphics mode and configure colours
#console --x 800 --y 600 --picture riddick.png
#colour --basic 3 --rgb 0xffaa44 3
#cpair --foreground 0 --background 3 2
#cpair --foreground 3 3
#set chotkey ${bold}
#set cname ${orange}


:start
menu PXE Boot Options
item shell iPXE shell
item fedora-core-os-bootstrap-net Fedora Core OS 39 installation
item exit  Exit to BIOS

choose --default fedora-core-os-bootstrap-net --timeout 10000 option && goto ${option}

:shell
shell

:fedora-core-os-bootstrap-net
set SERVER http://{{ loadbalancer }}:8000
set PATH /media/fedora-coreos
set VERSION {{ fcos_version.stdout }}
set ARCH x86_64
kernel ${SERVER}${PATH}/fedora-coreos-${VERSION}-live-kernel-${ARCH} initrd=main coreos.live.rootfs_url=${SERVER}${PATH}/fedora-coreos-${VERSION}-live-rootfs.${ARCH}.img coreos.inst.install_dev=/dev/sda coreos.inst.ignition_url=${SERVER}/bootstrap_{{ bootstrap[0].name }}.ign  
initrd --name main ${SERVER}${PATH}/fedora-coreos-${VERSION}-live-initramfs.${ARCH}.img 
boot

:exit
exit